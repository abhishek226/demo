"use strict";function encodePath(t){for(var e=t.split("/"),r=e.length;r--;)e[r]=encodeUriSegment(e[r]);return e.join("/")}function parseAbsoluteUrl(t,e){var r=urlResolve(t);e.$$protocol=r.protocol,e.$$host=r.hostname,e.$$port=toInt(r.port)||DEFAULT_PORTS[r.protocol]||null}function parseAppUrl(t,e){var r="/"!==t.charAt(0);r&&(t="/"+t);var i=urlResolve(t);e.$$path=decodeURIComponent(r&&"/"===i.pathname.charAt(0)?i.pathname.substring(1):i.pathname),e.$$search=parseKeyValue(i.search),e.$$hash=decodeURIComponent(i.hash),e.$$path&&"/"!=e.$$path.charAt(0)&&(e.$$path="/"+e.$$path)}function beginsWith(t,e){return 0===e.indexOf(t)?e.substr(t.length):void 0}function stripHash(t){var e=t.indexOf("#");return-1==e?t:t.substr(0,e)}function trimEmptyHash(t){return t.replace(/(#.+)|#$/,"$1")}function stripFile(t){return t.substr(0,stripHash(t).lastIndexOf("/")+1)}function serverBase(t){return t.substring(0,t.indexOf("/",t.indexOf("//")+2))}function LocationHtml5Url(t,e,r){this.$$html5=!0,r=r||"",parseAbsoluteUrl(t,this),this.$$parse=function(t){var r=beginsWith(e,t);if(!isString(r))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',t,e);parseAppUrl(r,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var t=toKeyValue(this.$$search),r=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(t?"?"+t:"")+r,this.$$absUrl=e+this.$$url.substr(1)},this.$$parseLinkUrl=function(i,s){if(s&&"#"===s[0])return this.hash(s.slice(1)),!0;var n,a,o;return isDefined(n=beginsWith(t,i))?(a=n,o=isDefined(n=beginsWith(r,n))?e+(beginsWith("/",n)||n):t+a):isDefined(n=beginsWith(e,i))?o=e+n:e==i+"/"&&(o=e),o&&this.$$parse(o),!!o}}function LocationHashbangUrl(t,e,r){parseAbsoluteUrl(t,this),this.$$parse=function(i){function s(t,e,r){var i,s=/^\/[A-Z]:(\/.*)/;return 0===e.indexOf(r)&&(e=e.replace(r,"")),s.exec(e)?t:(i=s.exec(t),i?i[1]:t)}var n,a=beginsWith(t,i)||beginsWith(e,i);isUndefined(a)||"#"!==a.charAt(0)?this.$$html5?n=a:(n="",isUndefined(a)&&(t=i,this.replace())):(n=beginsWith(r,a),isUndefined(n)&&(n=a)),parseAppUrl(n,this),this.$$path=s(this.$$path,n,t),this.$$compose()},this.$$compose=function(){var e=toKeyValue(this.$$search),i=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(e?"?"+e:"")+i,this.$$absUrl=t+(this.$$url?r+this.$$url:"")},this.$$parseLinkUrl=function(e,r){return stripHash(t)==stripHash(e)?(this.$$parse(e),!0):!1}}function LocationHashbangInHtml5Url(t,e,r){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(i,s){if(s&&"#"===s[0])return this.hash(s.slice(1)),!0;var n,a;return t==stripHash(i)?n=i:(a=beginsWith(e,i))?n=t+r+a:e===i+"/"&&(n=e),n&&this.$$parse(n),!!n},this.$$compose=function(){var e=toKeyValue(this.$$search),i=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(e?"?"+e:"")+i,this.$$absUrl=t+r+this.$$url}}function locationGetter(t){return function(){return this[t]}}function locationGetterSetter(t,e){return function(r){return isUndefined(r)?this[t]:(this[t]=e(r),this.$$compose(),this)}}function $LocationProvider(){var t="",e={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(e){return isDefined(e)?(t=e,this):t},this.html5Mode=function(t){return isBoolean(t)?(e.enabled=t,this):isObject(t)?(isBoolean(t.enabled)&&(e.enabled=t.enabled),isBoolean(t.requireBase)&&(e.requireBase=t.requireBase),isBoolean(t.rewriteLinks)&&(e.rewriteLinks=t.rewriteLinks),this):e},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(r,i,s,n,a){function o(t,e,r){var s=$.url(),n=$.$$state;try{i.url(t,e,r),$.$$state=i.state()}catch(a){throw $.url(s),$.$$state=n,a}}function h(t,e){r.$broadcast("$locationChangeSuccess",$.absUrl(),t,$.$$state,e)}var $,l,c,u=i.baseHref(),p=i.url();if(e.enabled){if(!u&&e.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");c=serverBase(p)+(u||"/"),l=s.history?LocationHtml5Url:LocationHashbangInHtml5Url}else c=stripHash(p),l=LocationHashbangUrl;var f=stripFile(c);$=new l(c,f,"#"+t),$.$$parseLinkUrl(p,p),$.$$state=i.state();var d=/^\s*(javascript|mailto):/i;n.on("click",function(t){if(e.rewriteLinks&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&2!=t.which&&2!=t.button){for(var s=jqLite(t.target);"a"!==nodeName_(s[0]);)if(s[0]===n[0]||!(s=s.parent())[0])return;var o=s.prop("href"),h=s.attr("href")||s.attr("xlink:href");isObject(o)&&"[object SVGAnimatedString]"===o.toString()&&(o=urlResolve(o.animVal).href),d.test(o)||!o||s.attr("target")||t.isDefaultPrevented()||$.$$parseLinkUrl(o,h)&&(t.preventDefault(),$.absUrl()!=i.url()&&(r.$apply(),a.angular["ff-684208-preventDefault"]=!0))}}),trimEmptyHash($.absUrl())!=trimEmptyHash(p)&&i.url($.absUrl(),!0);var b=!0;return i.onUrlChange(function(t,e){return isUndefined(beginsWith(f,t))?void(a.location.href=t):(r.$evalAsync(function(){var i,s=$.absUrl(),n=$.$$state;t=trimEmptyHash(t),$.$$parse(t),$.$$state=e,i=r.$broadcast("$locationChangeStart",t,s,e,n).defaultPrevented,$.absUrl()===t&&(i?($.$$parse(s),$.$$state=n,o(s,!1,n)):(b=!1,h(s,n)))}),void(r.$$phase||r.$digest()))}),r.$watch(function(){var t=trimEmptyHash(i.url()),e=trimEmptyHash($.absUrl()),n=i.state(),a=$.$$replace,l=t!==e||$.$$html5&&s.history&&n!==$.$$state;(b||l)&&(b=!1,r.$evalAsync(function(){var e=$.absUrl(),i=r.$broadcast("$locationChangeStart",e,t,$.$$state,n).defaultPrevented;$.absUrl()===e&&(i?($.$$parse(t),$.$$state=n):(l&&o(e,a,n===$.$$state?null:$.$$state),h(t,n)))})),$.$$replace=!1}),$}]}var PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location"),locationPrototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(t){if(isUndefined(t))return this.$$url;var e=PATH_MATCH.exec(t);return(e[1]||""===t)&&this.path(decodeURIComponent(e[1])),(e[2]||e[1]||""===t)&&this.search(e[3]||""),this.hash(e[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(t){return t=null!==t?t.toString():"","/"==t.charAt(0)?t:"/"+t}),search:function(t,e){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(t)||isNumber(t))t=t.toString(),this.$$search=parseKeyValue(t);else{if(!isObject(t))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");t=copy(t,{}),forEach(t,function(e,r){null==e&&delete t[r]}),this.$$search=t}break;default:isUndefined(e)||null===e?delete this.$$search[t]:this.$$search[t]=e}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(t){return null!==t?t.toString():""}),replace:function(){return this.$$replace=!0,this}};forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(t){t.prototype=Object.create(locationPrototype),t.prototype.state=function(e){if(!arguments.length)return this.$$state;if(t!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(e)?null:e,this}});